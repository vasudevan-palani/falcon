"use strict";const n=require("electron"),d=require("node:os"),i=require("node:path");process.env.DIST_ELECTRON=i.join(__dirname,"..");process.env.DIST=i.join(process.env.DIST_ELECTRON,"../dist");process.env.VITE_PUBLIC=process.env.VITE_DEV_SERVER_URL?i.join(process.env.DIST_ELECTRON,"../public"):process.env.DIST;d.release().startsWith("6.1")&&n.app.disableHardwareAcceleration();process.platform==="win32"&&n.app.setAppUserModelId(n.app.getName());n.app.requestSingleInstanceLock()||(n.app.quit(),process.exit(0));let e=null;const a=i.join(__dirname,"../preload/index.js"),l=process.env.VITE_DEV_SERVER_URL,r=i.join(process.env.DIST,"index.html");async function c(){e=new n.BrowserWindow({title:"Main window",titleBarStyle:"hidden",width:1280,height:720,icon:i.join(process.env.VITE_PUBLIC,"favicon.ico"),webPreferences:{preload:a,nodeIntegration:!0,contextIsolation:!1,devTools:!0}}),e.setMinimumSize(1280,720),e.on("closed",()=>{e=null}),process.env.VITE_DEV_SERVER_URL?(e.loadURL(l),e.webContents.openDevTools()):e.loadFile(r),e.webContents.on("did-finish-load",()=>{e==null||e.webContents.send("main-process-message",new Date().toLocaleString())}),e.webContents.setWindowOpenHandler(({url:o})=>(o.startsWith("https:")&&n.shell.openExternal(o),{action:"deny"}))}n.app.whenReady().then(()=>{c();let o=e.getPosition();console.log(o),n.ipcMain.on("dblclick-navbar",()=>{e.isMaximized()?e.unmaximize():e.maximize()}),n.ipcMain.on("closeApp",(s,t,p)=>{e.close()}),n.ipcMain.on("minimizeApp",(s,t,p)=>{e.minimize()})});n.app.on("window-all-closed",()=>{e=null,process.platform!=="darwin"&&n.app.quit()});n.app.on("second-instance",()=>{e&&(e.isMinimized()&&e.restore(),e.focus())});n.app.on("activate",()=>{const o=n.BrowserWindow.getAllWindows();o.length?o[0].focus():c()});n.ipcMain.handle("open-win",(o,s)=>{const t=new n.BrowserWindow({webPreferences:{preload:a,nodeIntegration:!0,contextIsolation:!1}});process.env.VITE_DEV_SERVER_URL?t.loadURL(`${l}#${s}`):t.loadFile(r,{hash:s})});
